clearPasswordFields=!0,includePasswordLength=!0;async function checkPass(t){var e=SHA1(t),n=(e=e.toUpperCase()).substring(5);return p=fetch("https://api.pwnedpasswords.com/range/"+e.substring(0,5)).then(t=>t.text()).then(t=>{for(var e=t.split("\n"),a=0;a<e.length;a++)if(r=e[a].split(":"),rhash=r[0],count=r[1].trim(),n==rhash)return count;return 0}).catch(t=>(console.log(t),-1)),p}function getPwdInputs(t){for(var e=[],r=t.getElementsByTagName("input"),n=0;n<r.length;n++)"password"===r[n].type.toLowerCase()&&e.push(r[n]);return e}function addHiddenInput(t,e,r){input=document.createElement("input"),input.setAttribute("name",e),input.setAttribute("value",r),input.setAttribute("type","hidden"),t.appendChild(input)}function SHA1(t){function e(t,e){return t<<e|t>>>32-e}function r(t){var e,r="";for(e=7;e>=0;e--)r+=(t>>>4*e&15).toString(16);return r}var n,a,o,s,u,i,d,h,p,c=new Array(80),g=1732584193,C=4023233417,f=2562383102,l=271733878,w=3285377520,m=(t=function(t){t=t.replace(/\r\n/g,"\n");for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);n<128?e+=String.fromCharCode(n):n>127&&n<2048?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}(t)).length,A=new Array;for(a=0;a<m-3;a+=4)o=t.charCodeAt(a)<<24|t.charCodeAt(a+1)<<16|t.charCodeAt(a+2)<<8|t.charCodeAt(a+3),A.push(o);switch(m%4){case 0:a=2147483648;break;case 1:a=t.charCodeAt(m-1)<<24|8388608;break;case 2:a=t.charCodeAt(m-2)<<24|t.charCodeAt(m-1)<<16|32768;break;case 3:a=t.charCodeAt(m-3)<<24|t.charCodeAt(m-2)<<16|t.charCodeAt(m-1)<<8|128}for(A.push(a);A.length%16!=14;)A.push(0);for(A.push(m>>>29),A.push(m<<3&4294967295),n=0;n<A.length;n+=16){for(a=0;a<16;a++)c[a]=A[n+a];for(a=16;a<=79;a++)c[a]=e(c[a-3]^c[a-8]^c[a-14]^c[a-16],1);for(s=g,u=C,i=f,d=l,h=w,a=0;a<=19;a++)p=e(s,5)+(u&i|~u&d)+h+c[a]+1518500249&4294967295,h=d,d=i,i=e(u,30),u=s,s=p;for(a=20;a<=39;a++)p=e(s,5)+(u^i^d)+h+c[a]+1859775393&4294967295,h=d,d=i,i=e(u,30),u=s,s=p;for(a=40;a<=59;a++)p=e(s,5)+(u&i|u&d|i&d)+h+c[a]+2400959708&4294967295,h=d,d=i,i=e(u,30),u=s,s=p;for(a=60;a<=79;a++)p=e(s,5)+(u^i^d)+h+c[a]+3395469782&4294967295,h=d,d=i,i=e(u,30),u=s,s=p;g=g+s&4294967295,C=C+u&4294967295,f=f+i&4294967295,l=l+d&4294967295,w=w+h&4294967295}return(p=r(g)+r(C)+r(f)+r(l)+r(w)).toLowerCase()}document.addEventListener("submit",async t=>{for(t.preventDefault(),pwinputs=getPwdInputs(t.target),i=0;i<pwinputs.length;i++){pwd=pwinputs[i].value,nm=pwinputs[i].name,""==nm&&(nm=pwinputs[i].id),!0===clearPasswordFields&&(pwinputs[i].value="");let e=await checkPass(pwd);textCount="Password Breach Count",textLength="Password Length",pwinputs.length>1&&""!=nm&&(textCount+=" ("+nm+")",textLength+=" ("+nm+")"),addHiddenInput(t.target,textCount,e),!0===includePasswordLength&&addHiddenInput(t.target,textLength,pwd.length)}t.target.submit()});